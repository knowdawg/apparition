[gd_scene load_steps=4 format=3 uid="uid://cuj56qr8m5w0d"]

[ext_resource type="Texture2D" uid="uid://d303m6gr121ap" path="res://Player/HealthBat/SwordHelathbar.png" id="2_n2d3e"]
[ext_resource type="PackedScene" uid="uid://b83nbeyca1lb2" path="res://Player/HealthBat/bar.tscn" id="3_rqctn"]

[sub_resource type="GDScript" id="GDScript_w73xr"]
script/source = "extends Control

var containers : Array = []

func _ready():
	for child in $Bars.get_children():
		if child is TextureProgressBar:
			containers.append(child)
	
	for bar in containers:
		bar.rotation_degrees = randf_range(-10.0, 10.0)

func hit(dmg : float, prevHealth : float):
	var startingIndex = floor(prevHealth - dmg)
	var endingIndex = floor(prevHealth)
	
	for i in endingIndex - startingIndex:
		containers[i + startingIndex].hit()

func update(health : float, MAX_HEALTH : float):
	var curBarIndex = floor(health)
	var curBarPercentage = (health - curBarIndex) * 100.0
	
	for i in curBarIndex:
		containers[i].value = 100
	
	for i in (containers.size() - curBarIndex - 1):
		containers[i + curBarIndex + 1].value = 0
	
	containers[curBarIndex].value = curBarPercentage
	
	for i in containers.size():
		if i > MAX_HEALTH - 1:
			containers[i].visible = false
		else:
			containers[i].visible = true

var upgradedSword = preload(\"res://Player/HealthBat/SwordHelathbarUpgrade.png\")
var upgraded = false
func upgradeSword():
	if upgraded == false:
		$Sword.texture = upgradedSword
		upgraded = true
"

[node name="HealthBarComponent" type="Control"]
clip_children = 2
texture_filter = 1
layout_mode = 3
anchors_preset = 0
script = SubResource("GDScript_w73xr")

[node name="Sword" type="Sprite2D" parent="."]
position = Vector2(60, 7.5)
texture = ExtResource("2_n2d3e")

[node name="Bars" type="Node2D" parent="."]
position = Vector2(60, 7)

[node name="Bar0" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -44.0
offset_top = -2.0
offset_right = -39.0
offset_bottom = 3.0

[node name="Bar1" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -39.0
offset_top = -2.0
offset_right = -34.0
offset_bottom = 3.0

[node name="Bar2" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -34.0
offset_top = -2.0
offset_right = -29.0
offset_bottom = 3.0

[node name="Bar3" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -29.0
offset_top = -2.0
offset_right = -24.0
offset_bottom = 3.0

[node name="Bar4" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -24.0
offset_top = -2.0
offset_right = -19.0
offset_bottom = 3.0

[node name="Bar5" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -19.0
offset_top = -2.0
offset_right = -14.0
offset_bottom = 3.0

[node name="Bar6" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -14.0
offset_top = -2.0
offset_right = -9.0
offset_bottom = 3.0

[node name="Bar7" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -9.0
offset_top = -2.0
offset_right = -4.0
offset_bottom = 3.0

[node name="Bar8" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = -4.0
offset_top = -2.0
offset_right = 1.0
offset_bottom = 3.0

[node name="Bar9" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 1.0
offset_top = -2.0
offset_right = 6.0
offset_bottom = 3.0

[node name="Bar10" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 6.0
offset_top = -2.0
offset_right = 11.0
offset_bottom = 3.0

[node name="Bar11" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 11.0
offset_top = -2.0
offset_right = 16.0
offset_bottom = 3.0

[node name="Bar12" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 16.0
offset_top = -2.0
offset_right = 21.0
offset_bottom = 3.0

[node name="Bar13" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 21.0
offset_top = -2.0
offset_right = 26.0
offset_bottom = 3.0

[node name="Bar14" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 26.0
offset_top = -2.0
offset_right = 31.0
offset_bottom = 3.0

[node name="Bar15" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 31.0
offset_top = -2.0
offset_right = 36.0
offset_bottom = 3.0

[node name="Bar16" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 36.0
offset_top = -2.0
offset_right = 41.0
offset_bottom = 3.0

[node name="Bar17" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 41.0
offset_top = -2.0
offset_right = 46.0
offset_bottom = 3.0

[node name="Bar18" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 46.0
offset_top = -2.0
offset_right = 51.0
offset_bottom = 3.0

[node name="Bar19" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 51.0
offset_top = -2.0
offset_right = 56.0
offset_bottom = 3.0

[node name="Bar20" parent="Bars" instance=ExtResource("3_rqctn")]
offset_left = 56.0
offset_top = -2.0
offset_right = 61.0
offset_bottom = 3.0
